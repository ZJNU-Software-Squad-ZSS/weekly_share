# HTTP学习笔记

### 请求响应的工作机制

HTTP由请求和响应构成，是一个标准的客户端服务器模型（B/S）。HTTP协议永远都是客户端发起请求，服务器回送响应。

**注意**：客户端与服务器的角色不是固定的，**一端充当客户端，也可能在某次请求中充当服务器**。这取决与请求的发起端。HTTP协议属于应用层，建立在传输层协议TCP之上。客户端通过与服务器**建立TCP连接**，之后**发送HTTP请求**与**接收HTTP响应**都是通过访问Socket接口来调用TCP协议实现。

客户端通过**TCP连接**发送**请求报文**，服务器收到请求后向其传输文件并返回**响应报文**。

- **请求报文**

  ```
    GET /index.html HTTP/1.1
    Host: www.XXXXXXXX
    Content-Length: 16
  ```

  请求报文是由**请求方法**，**请求URI**，**协议版本**，**可选的首部字段**以及**内容实体**构成。

  本例中，GET表示请求方法，/index.jsp是请求URL，HTTP/1.1是协议版本，其余的是首部字段。

- **响应报文**

  ```
    HTTP/1.1 200 OK 
    Date: XXXXXXXXX
    Content-Length: 300
    Content-Type: text/html
  ```

  响应报文基本上由**协议版本**，**状态码**(返回请求成功或失败情况)，对**状态码的解释短语**，**可选的首部字段**以及**内容实体**构成。

  本例中，HTTP/1.1表示**协议版本**，200表示**状态码**，OK是**对状态码的描述**，Date是**响应日期**，与Content-Length和Content-Type一样，都属于**首部字段**。

  

### 访问的无状态性

 HTTP是一个无状态的协议。无状态是指客户机（Web浏览器）和服务器之间不需要建立持久的连接，这意味着当一个客户端向服务器端发出请求，然后服务器返回响应(response)，连接就被关闭了，在服务器端不保留连接的有关信息。

HTTP协议本身**不会**对发送过的请求和相应的通信状态进行**持久化处理**。这样做的目的是为了保持HTTP协议的简单性，从而能够**快速处理**大量的事务，提高效率。

然而，在许多应用场景中，我们需要保持用户登录的状态或记录用户购物车中的商品。由于HTTP是无状态协议，所以必须引入一些技术来**记录管理状态**，例如**Cookie**和**Session**。

##### Cookie

Cookie技术通过请求和响应报文中写入Cookie信息来控制客户端的状态。

Cookie通过响应报文中的Set-Cookie的首部字段信息，通知客户端保存Cookie，当下次客户端再次发往服务器请求时，客户端会自动在请求报文中加入cookie值。服务器端发现客户端发送来得Cookie后，检查从哪个客户端发来的连接请求，然后对比服务器的记录，最后得到状态信息。

**Session**

Session:在计算机中，尤其是在网络应用中，称为“会话控制”。Session 对象存储特定用户会话所需的属性及配置信息。这样，当用户在应用程序的 Web 页之间跳转时，存储在 Session 对象中的变量将不会丢失，而是在整个用户会话中一直存在下去。当用户请求来自应用程序的 Web 页时，如果该用户还没有会话，则 Web 服务器将自动创建一个 Session 对象。当会话过期或被放弃后，服务器将终止该会话。
session的底层是基于cookie技术来实现的，当用户打开浏览器，去访问服务器的时候，服务器会为每个用户的浏览器创建一个会话对象(session对象)，并且为每个session对象创建一个Jsessionid号。当session对象创建成功后，会以cookie的方式将这个Jsessionid号回写给浏览器，当用户再次进行访问服务器时，及带了具有Jsessionid号的cookie数据来一起访问服务器，服务器通过不同session的 Jsessionid号来找出与其相关联的session对象，通过不同的session对象来为不同的用户服务。
服务器需要保存的数据可以以cookie的方式存储在客户端，而session的功能就是将服务器需要保存的数据存储在服务端。

**session和cookie的区别**

cookie是将用户的数据写给客户端（浏览器） 
 session是把用户数据写到服务器中用户独占的session里

------

Reference：https://www.cnblogs.com/ACFLOOD/p/5571464.html   、 https://www.cnblogs.com/cs19860814/p/8067660.html  、 https://blog.csdn.net/yuehenhn/article/details/51457625

2020/2/22
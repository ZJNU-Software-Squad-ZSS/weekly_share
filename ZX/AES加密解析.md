# AES加密解析

- ## AES加密过程：

  为方便概述，这里以16字节规格的明文为例子。直接开始讲过程。

  <img src = "C:\Users\19788\AppData\Roaming\Typora\typora-user-images\1572517184729.png" align = "left" float="left">这是输入的明文矩阵。矩阵中的一个元素代表一个字节，字节有8个比特。化成16进制就是两位16进制的数。

  

  

  



## 步骤一

字节代替（Substitute Bytes）：用S盒完成；

举例：取明文中的 $S_{0,0}$假设值为{A5}，那么就找到s盒中的第十行第五列，然后把{A5}改成s盒中对应的数字。

<img src = "C:\Users\19788\AppData\Roaming\Typora\typora-user-images\1572519842098.png" width="50%" align= "left" float = "left">这个是s盒，以上述为例，{A5}改成{06}









重点理解S盒构造方法：

1. 初始化S盒，为{00}{01}...{FF}

2. 求S盒中对应的值在$GF(2^8)$下的逆元。举例{F5}转化成二级制为11110101. 对应的多项式为：$x^7+x^6+x^5+x^4+x^2+1$。也就是设多项式y使得
   $$
   y*(x^7+x^6+x^5+x^4+x^2+1) \equiv 1 (mod\quad x^8+x^4+x^3+x+1)
   $$
   最终可求得$y=x^6+x^2+x$,转化成二级制就是01000110，也就是{46}。

   接着根据约定俗成的矩阵相乘得到一个新的二进制数。

   <img src = "C:\Users\19788\AppData\Roaming\Typora\typora-user-images\1572520957833.png" width="30%" align = "left">其中在求得y之后，按低位向高位以此向下排列，与矩阵相乘。

   可求得位列向量$b_0\thicksim b_7$= {10100001}.





在求得位列向量之后，把该向量与{11000110}取异或操作。

$\left[
\matrix{
b_{0}^{'}\\b_{1}^{'}\\b_{2}^{'}\\b_{3}^{'}\\b_{4}^{'}\\b_{5}^{'}\\b_{6}^{'}\\b_{7}^{'}}
\right]=\left[
\matrix{
1\\0\\1\\0\\0\\0\\0\\1}
\right] \bigoplus \left[
\matrix{
1\\1\\0\\0\\0\\1\\1\\0}
\right] = \left[
\matrix{
0\\1\\1\\0\\0\\1\\1\\1}
\right] $

所以得$b_{7}^{'} \thicksim b_{0}^{'}$为{11100110}。也就是{E6}。查S盒的表可得，第F行第5列为{E6}。

构造S盒的难点在于求多项式的逆元，请大家要熟练掌握求多项式的逆元。

## 步骤二

行移位（ShiftRows）：置换

   对于已经进行过字节代替的明文，行位移的做法是第0行向左移动0个字节，第1行向左移动1个字节，把
溢出的字节添在丢失的字节位上。

## 步骤三

列混淆（MixColumns）：利用$GF(2^8)$

  书上的方法可能看起来比较难以理解，所以我打算用自己的方法来写。
当我们在步骤二完成后，已经求出了一个全新的矩阵，现在我们需要把这个矩阵乘以一个规定的矩阵。

<img src="C:\Users\19788\AppData\Roaming\Typora\typora-user-images\1572523341633.png" width = "50%" align = "left">作为其中的一个例子，我们计算一下{03}*$S_{1,0}$。



把{03}转化成16进制，{00000011}.对应的多项式为$x+1$.那么现在就是求$[(x+1)*S_{1,0} ]\quad mod (x^8+x^4+x^3+x+1)$

那么问题就又转化成多项式的乘法与加法，并且在$GF(2^8)$的有限域下进行，即结果都要$mod (x^8+x^4+x^3+x+1)$
以上方法虽然麻烦点，但是便于理解。当理解上述方法后，就可以看懂书上的方法了。

## 步骤四

轮密钥加变换
  这步骤十分简单，不说了。
## ==Email应用的构成==

​    组件：

   * 邮件客户端（user agent）
   * 邮件服务器
   * SMTP协议(Simple Mail Transfer Protocol)

​        邮件客户端不多说，很简单。

​     核心：邮件服务器

                 1. 邮箱：存储该用户的Email
                 2. 消息队列：存储等待发送的Email

 ### ==SMTP协议：邮件服务器之间传递消息的协议==

   * 使用TCP进行Email消息的可靠传输

   * 端口是25！！！

   * 传输过程的阶段：

     1. 握手
     2. 消息传输
     3. 关闭

* 命令/响应交互模式

  1. 命令：ASCII文本
  2. 响应：状态代码和语句

* email消息只能包含7位ASCII码

  SMPT协议与HTTP协议

    ![1573211213034](https://s2.ax1x.com/2019/11/08/MZdIhQ.png)

  其中==pull式==指客户端把数据从服务器拉过来

  ==push==指客户自己主动把邮件发送过去

  ​     ==SMTP==需要重点学习，放在ppt里
  
  1. 头部行（header）
  
  2. 消息体
  
        * 消息本身
        * 只能是ASCII字符
  
  

## Emile怎么发送多媒体文件？

在邮件头部增加额外的行声明MIME的内容类型

==MIME==：多媒体邮件扩展RFC 2045, 2056

   过程：详见ppt

### ==邮件访问协议==：

​		定义：从服务器获取邮件

  * POP:Post Office Protocol [RFC 1939]

    ​	授权/认证和下载

* IMAP：Internet Mail Access Protocal [RFC 1730]

  	* 更多功能
  	* 更加复杂
  	* 能够操纵服务器上存储的信息

* HTTP：163、QQ Mail，运行在web上的邮件

  

   ### POP模式

		1. 下载并删除：如果用户换了客户端软件，无法重读。
  		2. 下载并保持：不同客户端都可以保留消息

POP3是无状态的

### IMAP协议

		1. 所以消息统一保存在一个地方：服务器
  		2. 允许用户利用文件夹组织消息
  		3. IMAP支持跨会话的用户状态：意味着类似与百度云一样，可创建文件夹来对邮件进行分类
       * 文件夹名字
       * 文件夹与消息ID之间的映射

## 课外查询

  1. POP与IMAP协议的区别：

     * IMAP可以通过邮件客户端对邮件进行操作，而POP在用户下载了邮件后，就会删除在邮件服务器上的邮件

     * 对与IMAP，用户在客户端上的操作会反馈到服务器，在Web上的操作也会显示在客户端上。同步更新邮箱中的消息。对POP3，用户在客户端上的操作不会反馈到服务器上

     * IMAP提供更加便捷、稳定、可靠的使用体验，通过WebMail与客户端进行双向通信可以避免邮件丢失。

       POP3更容易丢失邮件，也不能多次下载相同的邮件（目前的很多POP3邮件服务器已经支持保留原邮件，支持多次下载）。

     * IMAP提供了从多台设备访问邮件，便于随时查阅。提供的摘要功能便于查询时间，主题等信息然后再决定是否下载